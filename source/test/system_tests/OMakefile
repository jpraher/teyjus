SUBDIRS = $(glob D, *)

.PHONY: system-test
system-test: $(TJSIM)
    perl harness

.SUBDIRS: $(SUBDIRS)
    # The default root file is the name of the test directory
    ROOT = $(basename $(absname $(CWD)))

    # The default root file can be overriden if the test directory contains
    # a file named root.om with a line "ROOT = xxxx"
    if $(file-exists root.om)
        include root.om
        export

    FILES = $(rootname $(glob *.mod))

    LPProgram($(ROOT), $(FILES))
    system-test: $(ROOT).lp

    clean:
        rm -f *.lp *.lpo
